<div class="mb-6">
  <a href="/admin/batches" class="text-cyan-400 hover:text-cyan-300 text-sm">&larr; Back to Batches</a>
</div>

<div class="bg-dark-700 border border-dark-500 rounded-xl p-5 mb-6">
  <h1 class="text-xl font-semibold text-white mb-4">
    Batch <span class="text-cyan-400">#<%= batch.batchNumber %></span>
    <span class="text-gray-500 font-normal text-base ml-2"><%= batch.weekId %></span>
  </h1>
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
    <div>
      <span class="text-gray-500">Status</span>
      <p class="mt-1">
        <span class="px-2 py-0.5 text-xs rounded-full
          <%= batch.status === 'completed' ? 'bg-emerald-500/20 text-emerald-400' :
             batch.status === 'failed' ? 'bg-red-500/20 text-red-400' :
             batch.status === 'processing' ? 'bg-cyan-500/20 text-cyan-400' :
             'bg-yellow-500/20 text-yellow-400' %>">
          <%= batch.status %>
        </span>
      </p>
    </div>
    <div>
      <span class="text-gray-500">Recipients</span>
      <p class="text-white font-medium mt-1"><%= batch.recipientCount %></p>
    </div>
    <div>
      <span class="text-gray-500">Retries</span>
      <p class="text-gray-300 mt-1"><%= batch.retryCount %>/<%= batch.maxRetries %></p>
    </div>
    <% if (batch.execution) { %>
    <div>
      <span class="text-gray-500">Gas Used</span>
      <p class="text-gray-300 mt-1"><%= batch.execution.gasUsed || 'â€”' %></p>
    </div>
    <% } %>
  </div>

  <% if (batch.execution?.txHash) { %>
  <div class="mt-4 pt-4 border-t border-dark-500">
    <span class="text-gray-500 text-sm">Transaction</span>
    <a href="https://basescan.org/tx/<%= batch.execution.txHash %>" target="_blank"
       class="block mt-1 text-cyan-400 hover:text-cyan-300 font-mono text-sm break-all"><%= batch.execution.txHash %></a>
  </div>
  <% } %>

  <% if (batch.lastError) { %>
  <div class="mt-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm">
    <%= batch.lastError %>
  </div>
  <% } %>
</div>

<div class="bg-dark-700 border border-dark-500 rounded-xl overflow-hidden">
  <div class="px-5 py-4 border-b border-dark-500">
    <h2 class="text-base font-medium text-white">Recipients in Batch</h2>
  </div>
  <table class="w-full">
    <thead>
      <tr class="bg-dark-800/50">
        <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase">Address</th>
        <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase">Amount</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-dark-600">
      <% batch.recipients.forEach(r => { %>
      <tr class="hover:bg-dark-600/30 transition-colors">
        <td class="px-5 py-3">
          <a href="/admin/search?address=<%= r.address %>" class="font-mono text-sm text-cyan-400 hover:text-cyan-300"><%= r.address %></a>
        </td>
        <td class="px-5 py-3 text-sm text-emerald-400 font-medium"><%= (BigInt(r.amount) / BigInt(10**18)).toString() %> ETH</td>
      </tr>
      <% }) %>
      <% if (batch.recipients.length === 0) { %>
      <tr>
        <td colspan="2" class="px-5 py-8 text-center text-gray-500 text-sm">No recipients in batch</td>
      </tr>
      <% } %>
    </tbody>
  </table>
</div>

<% if (pagination && pagination.totalPages > 1) { %>
<div class="mt-4 flex justify-center gap-2">
  <% for (let i = 1; i <= pagination.totalPages; i++) { %>
  <a href="?page=<%= i %>" class="px-3 py-1 text-sm rounded <%= i === pagination.page ? 'bg-cyan-500 text-white' : 'bg-dark-700 text-gray-400 hover:text-white' %>"><%= i %></a>
  <% } %>
</div>
<% } %>
